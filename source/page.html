<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MD-File</title>
    <link rel="stylesheet" href="standard.css" id="themeStyle">
    <link rel="stylesheet" href="source/katex/katex.min.css">

</head>
<body>
    <div class="main-container"></div>
        <div class="header">
            <h1><strong>Title</strong></h1>
            <nav>
                <a href="../index.html">Home</a>
                <a href="https://github.com/thhaase">GitHub</a>
                <a href="#" id="themeSwitcher">Switch Theme</a>
                <button onclick="window.print();" class="nav-button">Print</button>
            </nav>
        </div>

        <div id="pageContent"></div>


        <!-- display pages -->
        <script>
            const queryParams = new URLSearchParams(window.location.search);
            const pageName = queryParams.get('name');

            if (pageName) {
                fetch(`../${pageName}.md`)
                    .then(response => response.text())
                    .then(text => {
                        document.getElementById('pageContent').innerHTML = parseMarkdown(text);
                    })
                    .catch(error => console.error('Error loading page:', error));
            } else {
                document.getElementById('pageContent').innerHTML = '<p>Page not found.</p>';
            }
        </script>
    </div>


    <!-- Include the Markdownparser -->
    <script src="markdownParser.js"></script>
    <!-- katex scripts -->
    <script src="source/katex/katex.min.js"></script>
    <script src="source/katex/contrib/auto-render.min.js"></script>


  <script>
    // links to other markdown documents are easy now 
    document.addEventListener('DOMContentLoaded', (event) => {
        document.body.addEventListener('click', function(e) {
            if (e.target.tagName === 'A' && e.target.href.endsWith('.md')) {
                e.preventDefault(); // Prevent the default link behavior
                const mdFileName = e.target.getAttribute('href');
                const pageName = mdFileName.replace('.md', ''); // Remove the .md extension
                window.location.href = `page.html?name=${pageName}`; // Redirect to page.html with the proper query parameter
            }
        });
    });
  </script>

  <!-- themeswitcher ID switched themes; use of local storage to keep the theme when opening links-->
  <script>
    function changeTheme() {
      var themeStyle = document.getElementById('themeStyle');
      if (themeStyle.getAttribute('href') === 'standard.css') {
        themeStyle.setAttribute('href', 'second.css');
        sessionStorage.setItem('theme', 'second.css'); // Store the selection in sessionStorage
      } else {
        themeStyle.setAttribute('href', 'standard.css');
        sessionStorage.setItem('theme', 'standard.css'); // Store the selection in sessionStorage
      }
    }

    // Event listener for the theme switcher
    document.getElementById('themeSwitcher').addEventListener('click', function(e) {
      e.preventDefault();
      changeTheme();
    });

    // Apply the stored theme on page load
    window.onload = function() {
      var savedTheme = sessionStorage.getItem('theme');
      if (savedTheme) {
        document.getElementById('themeStyle').setAttribute('href', savedTheme);
      }
    };
  </script>
    
<!-- render Katex after markdown is rendered-->
<script>
  // Fetch and render markdown
  fetch('index.md')
      .then(response => response.text())
      .then(text => {
          const contentElement = document.getElementById('content');
          contentElement.innerHTML = parseMarkdown(text);

          // Call KaTeX render method to process any LaTeX in the content
          renderMathInElement(contentElement, {
              delimiters: [
                  {left: "$$", right: "$$", display: true},
                  {left: "\\[", right: "\\]", display: true},
                  {left: "$", right: "$", display: false},
                  {left: "\\(", right: "\\)", display: false}
              ],
              ignoredTags: ["script", "noscript", "style", "textarea", "pre", "code"]
          });
      })
      .catch(error => console.error('Error loading markdown:', error));
</script>


</body>
</html>
